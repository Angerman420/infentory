
# Simple NaCl dissociation example (WIP)

The OpenMM engine is as of now based on the `external_ase` branch of infretis.

Instead of using an ASE calculator and send positions and forces back and forth between ASE and OpenMM runs `subcycles` steps, and then simply passes positions, velocities and box information to ASE, which is used to calculate the orderparameter.

To use openmm, one needs a `system.xml` and `topology.pdb` file, which is used to set up the openmm simulation. See `openmmcalculator.py` for how this is done. Here, one can change `subcycles`, `timestep` and all other system settings. The files `openmm_input/` were generated with the `openmm_input/create_system.py` script.

A limitation as of now is velocities are generated by ASE without taking constraints into accound, but constraints can be enforced to velocities in the setup step of the `OpenMMCalculator.calculate` function, which is performed once everytime we propagate the dynamics in a single trajectory.

# intial paths
`cstep=-1` does not work with infinit as of now due to some folder issues, sidestep this by using

```bash
export OPENMM_CPU_THREADS=1
inft generate_zero_paths -conf openmm_input/initial.traj -toml infretis0.toml &
python -m infretis.classes.engines.propagator infretis0.toml temporary_load
```
Then
```
inft infinit -toml infretis0.toml &
python -m infretis.classes.engines.propagator infretis0.toml worker0
```
